define("taoSync/controller/routes",[],function(){"use strict";return{Synchronizer:{actions:{index:"taoSync/controller/synchronizer/index"}},SynchronizationHistory:{actions:{index:"taoSync/controller/SynchronizationHistory/index"}}}}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("lodash")):"function"==typeof define&&define.amd?define("core/format",["lodash"],factory):(global=global||self)["core/format"]=factory(global._)}(this,function(_){"use strict";_=_&&_.hasOwnProperty("default")?_.default:_;var pattern=/(%[sdj])/g;return function(message){var replacements=Array.prototype.slice.call(arguments
,1);return _.reduce(message.match(pattern),function(acc,match,index){var replacement="";if(void 0!==replacements[index]){switch(match){case"%d":replacement=Number(replacements[index]);break;case"%j":try{replacement=JSON.stringify(replacements[index]).replace(/"/g,"")}catch(e){}break;default:replacement=replacements[index]}message=message.replace(match,replacement)}return message},message)}}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory():"function"==typeof define&&define.amd?define("core/promise",factory):(global=global||self)["core/promise"]=factory()}(this,function(){"use strict";return Promise}),
function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("lodash"),require("core/format"),require("core/promise")):"function"==typeof define&&define.amd?define("core/logger/api",["lodash","core/format","core/promise"],factory):(global=global||self)["core/logger/api"]=factory(global._,global["core/format"],global["core/promise"])}(this,function(_,format,Promise){"use strict";_=_&&_.hasOwnProperty("default")?_.default:_,format=format&&format.hasOwnProperty("default")?format.default:format,Promise=Promise&&Promise.hasOwnProperty("default")?Promise.default:Promise;function loggerFactory(name,minLevel,fields){
var baseRecord,logger;if(!_.isString(name)||_.isEmpty(name))throw new TypeError("A logger needs a name");return _.isPlainObject(minLevel)&&"undefined"==typeof field&&(fields=minLevel,minLevel=defaultLevel),baseRecord=_.defaults(fields||{},{name:name,pid:1,hostname:navigator.userAgent}),logger={log:function(level,recordFields,message){var record,err,rest=[],time=(new Date).toISOString();if(!1!==loggerFactory.providers&&checkMinLevel(minLevel||defaultLevel,level))return rest=_.isString(recordFields)||recordFields instanceof Error?(message=recordFields,recordFields={},[].slice.call(arguments,2)):[].slice.call(arguments,3),record={level:getLevel(level),v:0,
time:time},checkMinLevel(levels.error,level)||message instanceof Error?(err=message instanceof Error?message:(message=_.isObject(message)?JSON.stringify(message):message,new Error(message)),record.msg=err.message,record.err=err):record.msg=format.apply(null,[message].concat(rest)),_.merge(record,baseRecord,recordFields),logQueue.push(record),loggerFactory.flush(),this},level:function(value){return void 0!==value?(minLevel=getLevelNum(value),this):getLevel(minLevel)},child:function(childFields){return loggerFactory(name,minLevel,_.defaults(childFields,baseRecord))}},_.reduce(levels,function(target,level,levelName){return target[levelName]=_.partial(logger.log
,level),target},logger)}var defaultLevel="info",levels={fatal:60,error:50,warn:40,info:30,debug:20,trace:10},logQueue=[],getLevel=function(level){return void 0===level||_.isString(level)&&!_.has(levels,level)?defaultLevel:_.isNumber(level)?_.findKey(levels,function(l){return l===level})||defaultLevel:level},getLevelNum=function(level){return _.isString(level)&&_.has(levels,level)?levels[level]:_.isNumber(level)&&_.contains(levels,level)?level:levels[defaultLevel]},checkMinLevel=function(minLevel,level){return getLevelNum(level)>=getLevelNum(minLevel)};return loggerFactory.levels=levels,loggerFactory.providers=!1,loggerFactory.load=function(providerConfigs){
var self=this,modules=[];return this.providers=[],new Promise(function(resolve,reject){_.forEach(providerConfigs,function(providerConfig,providerName){modules.push(providerName)}),require(modules,function(){var loadedProviders=[].slice.call(arguments);_.forEach(loadedProviders,function(provider,moduleKey){try{self.register(provider,providerConfigs[modules[moduleKey]])}catch(err){reject(err)}}),self.flush(),resolve()},reject)})},loggerFactory.register=function(provider,providerConfig){if(!_.isPlainObject(provider)||!_.isFunction(provider.log))throw new TypeError("A log provider is an object with a log method");provider.checkMinLevel=checkMinLevel,
_.isFunction(provider.setConfig)&&provider.setConfig(providerConfig),this.providers=this.providers||[],this.providers.push(provider)},loggerFactory.flush=function(){_.isArray(this.providers)&&0<this.providers.length&&(_.forEach(logQueue,function(message){_.forEach(loggerFactory.providers,function(provider){provider.log.call(provider,message)})}),logQueue=[])},loggerFactory.setDefaultLevel=function(level){return defaultLevel=getLevel(level)},loggerFactory}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("lodash"),require("module"),require("core/logger/api")
):"function"==typeof define&&define.amd?define("core/logger",["lodash","module","core/logger/api"],factory):(global=global||self)["core/logger"]=factory(global._,global.module,global["core/logger/api"])}(this,function(_,module,loggerFactory){"use strict";_=_&&_.hasOwnProperty("default")?_.default:_,module=module&&module.hasOwnProperty("default")?module.default:module;var defaultConfig={level:(loggerFactory=loggerFactory&&loggerFactory.hasOwnProperty("default")?loggerFactory.default:loggerFactory).levels.warn,loggers:{"core/logger/console":{level:"warn"}}},config=_.defaults(module.config()||{},defaultConfig),logger=loggerFactory("core/logger")
;return loggerFactory.setDefaultLevel(config.level),loggerFactory.load(config.loggers),window.onerror=function(msg,url,line,col,error){logger.error("Caught[via window.onerror]: '"+msg+"' from "+url+":"+line+":"+col)},window.setTaoLogLevel=function(level){return loggerFactory.setDefaultLevel(level)},loggerFactory}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("lodash"),require("context")):"function"==typeof define&&define.amd?define("util/url",["lodash","context"],factory):(global=global||self)["util/url"]=factory(global._,global.context)}(this,function(_,context){"use strict"
;_=_&&_.hasOwnProperty("default")?_.default:_,context=context&&context.hasOwnProperty("default")?context.default:context;var parsers={absolute:/^(?:[a-z]+:)?\/\//i,base64:/^data:[^\/]+\/[^;]+(;charset=[\w]+)?;base64,/,query:/(?:^|&)([^&=]*)=?([^&]*)/g,url:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/};return{parse:function(url){var matches,keys=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","queryString","hash"],i=keys.length,parsed=Object.create({toString:function(){return this.source}});if(
parsed.base64=parsers.base64.test(url),parsed.base64)parsed.source=url;else{for(matches=parsers.url.exec(url);i--;)parsed[keys[i]]=matches[i]||"";parsed.query={},parsed.queryString.replace(parsers.query,function($0,$1,$2){$1&&(parsed.query[$1]=$2)})}return parsed},isAbsolute:function(url){return"object"==typeof url&&url.hasOwnProperty("source")?url.source!==url.relative:"string"==typeof url?parsers.absolute.test(url):void 0},isRelative:function(url){var absolute=this.isAbsolute(url);if("boolean"==typeof absolute)return!absolute},isBase64:function(url){return"object"==typeof url&&url.hasOwnProperty("source"
)?url.base64:"string"==typeof url?parsers.base64.test(url):void 0},encodeAsXmlAttr:function(uri){return/[<>&']+/.test(uri)?encodeURIComponent(uri):uri},build:function(path,params){var url,hasQueryString,queryString="";return path&&(_.isString(path)&&(url=path),_.isArray(path)&&(url="",_.forEach(path,function(chunk){/\/$/.test(url)&&/^\//.test(chunk)?url+=chunk.substr(1):""===url||/\/$/.test(url)||/^\//.test(chunk)?url+=chunk:url+="/"+chunk})),_.isPlainObject(params)&&(hasQueryString=-1<url.indexOf("?"),queryString=_.reduce(params,function(acc,value,key){return _.isEmpty(acc)&&!hasQueryString||(acc+="&"),"object"!=typeof value||_.isArray(value
)?acc+=encodeURIComponent(key)+"="+encodeURIComponent(value):_.forOwn(value,function(parameterValue,parameterName){acc+=encodeURIComponent(key)+"["+encodeURIComponent(parameterName)+"]="+encodeURIComponent(parameterValue)+"&"}),acc},queryString),_.isEmpty(queryString)||(hasQueryString||(url+="?"),url+=queryString))),url},route:function(action,controller,extension,params,rootUrl){var routeParts=[extension,controller,action];if(_.some(routeParts,function(value){return _.isEmpty(value)||!_.isString(value)}))throw new TypeError("All parts are required to build an URL");return rootUrl=rootUrl||context&&context.root_url,this.build([rootUrl].concat(routeParts),
params)}}}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("lodash"),require("core/promise"),require("lib/uuid"),require("core/logger")):"function"==typeof define&&define.amd?define("core/eventifier",["lodash","core/promise","lib/uuid","core/logger"],factory):(global=global||self)["core/eventifier"]=factory(global._,global["core/promise"],global["lib/uuid"],global["core/logger"])}(this,function(_,Promise,uuid,loggerFactory){"use strict";_=_&&_.hasOwnProperty("default")?_.default:_,Promise=Promise&&Promise.hasOwnProperty("default")?Promise.default:Promise,uuid=uuid&&uuid.hasOwnProperty("default"
)?uuid.default:uuid,loggerFactory=loggerFactory&&loggerFactory.hasOwnProperty("default")?loggerFactory.default:loggerFactory;var defaultNs="@",eventifierLogger=loggerFactory("core/eventifier");function getEventNames(eventNames){return!_.isString(eventNames)||_.isEmpty(eventNames)?[]:_(eventNames.split(/\s/g)).compact().uniq().value()}function getName(eventName){return-1<eventName.indexOf(".")?eventName.substr(0,eventName.indexOf(".")):eventName}function getNamespace(eventName){return-1<eventName.indexOf(".")?eventName.substr(eventName.indexOf(".")+1):defaultNs}return function(target){var targetName,logger,stoppedEvents,eventHandlers={},getHandlers=function(
eventName,type){var name=getName(eventName),ns=getNamespace(eventName);return type=type||"between",eventHandlers[ns]=eventHandlers[ns]||{},eventHandlers[ns][name]=eventHandlers[ns][name]||{before:[],between:[],after:[]},eventHandlers[ns][name][type]},eventApi={on:function(eventNames,handler){return _.isFunction(handler)&&_.forEach(getEventNames(eventNames),function(eventName){getHandlers(eventName).push(handler)}),this},off:function(eventNames){return _.forEach(getEventNames(eventNames),function(eventName){var offNamespaces,name=getName(eventName),ns=getNamespace(eventName);ns&&!name?"*"===ns?((offNamespaces={})[defaultNs]=eventHandlers[defaultNs],
eventHandlers=offNamespaces):eventHandlers[ns]={}:_.forEach(eventHandlers,function(nsHandlers,namespace){!nsHandlers[name]||ns!==defaultNs&&ns!==namespace||(nsHandlers[name]={before:[],between:[],after:[]})})}),this},removeAllListeners:function(){return eventHandlers={},this},trigger:function(eventNames){var self=this,args=[].slice.call(arguments,1);function triggerBetween(allHandlers,event){shouldStop(event.name)?logHandlerStop("before",event):triggerHandlers(allHandlers.between,event).then(function(){!function(handlers,event){shouldStop(event.name)?logHandlerStop("on",event):triggerHandlers(handlers,event).then(function(){shouldStop(event.name
)&&logHandlerStop("after",event)}).catch(function(err){logHandlerStop("after",event,err)})}(allHandlers.after,event)}).catch(function(err){logHandlerStop("on",event,err)})}function triggerHandlers(handlers,event){var pHandlers;return pHandlers=handlers.map(function(handler){return shouldStop(event.name)?Promise.reject():handler.apply(self,args)}),Promise.all(pHandlers)}function logHandlerStop(stoppedIn,event,err){err instanceof Error&&logger.error(err),logger.trace({err:err,event:event.name,stoppedIn:stoppedIn},event.name+" handlers stopped")}function shouldStop(name){return stoppedEvents[name]}return stoppedEvents={},_.forEach(getEventNames(eventNames),
function(eventName){var ns=getNamespace(eventName),name=getName(eventName),mergedHandlers=_(eventHandlers).filter(function(nsHandlers,namespace){return nsHandlers[name]&&(ns===defaultNs||ns===namespace||"*"===namespace)}).reduce(function(acc,nsHandlers){return acc.before=acc.before.concat(nsHandlers[name].before),acc.between=acc.between.concat(nsHandlers[name].between),acc.after=acc.after.concat(nsHandlers[name].after),acc},{before:[],between:[],after:[]});logger.trace({event:eventName,args:args},"trigger %s",eventName),mergedHandlers&&function(allHandlers,name,ns){var event={name:name,namespace:ns};allHandlers.before.length?function(handlers,event){
var pHandlers,beforeArgs=args.slice();return beforeArgs.unshift(event),pHandlers=handlers.map(function(handler){var value=!shouldStop(event.name)&&handler.apply(self,beforeArgs);return!1===value?Promise.reject():value}),Promise.all(pHandlers)}(allHandlers.before,event).then(function(){triggerBetween(allHandlers,event)}).catch(function(err){logHandlerStop("before",event,err)}):triggerBetween(allHandlers,event)}(mergedHandlers,name,ns)}),this},before:function(eventNames,handler){return _.isFunction(handler)&&_.forEach(getEventNames(eventNames),function(eventName){getHandlers(eventName,"before").push(handler)}),this},after:function(eventNames,handler){
return _.isFunction(handler)&&_.forEach(getEventNames(eventNames),function(eventName){getHandlers(eventName,"after").push(handler)}),this},stopEvent:function(name){_.isString(name)&&!_.isEmpty(name.trim())&&(stoppedEvents[name.trim()]=!0)},spread:function(destination,eventNames){var self=this;return destination&&_.isFunction(destination.trigger)&&(_.isString(eventNames)&&(eventNames=getEventNames(eventNames)),_.forEach(eventNames,function(eventName){self.on(eventName,function(){var args=[eventName].concat([].slice.call(arguments));destination.trigger.apply(destination,args)})})),this}};return targetName=(target=target||{}
).name||target.id||target.serial||uuid(6),logger=eventifierLogger.child({target:targetName}),_(eventApi).functions().forEach(function(method){_.isFunction(target[method])&&eventifierLogger.warn("The target object has already a method named "+method,target),target[method]=function(){var args=[].slice.call(arguments);return eventApi[method].apply(target,args)}}),target}}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory():"function"==typeof define&&define.amd?define("util/regexEscape",factory):(global=global||self)["util/regexEscape"]=factory()}(this,function(){"use strict";return function(s){
return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("util/regexEscape")):"function"==typeof define&&define.amd?define("util/wrapLongWords",["util/regexEscape"],factory):(global=global||self)["util/wrapLongWords"]=factory(global["util/regexEscape"])}(this,function(regexEscape){"use strict";regexEscape=regexEscape&&regexEscape.hasOwnProperty("default")?regexEscape.default:regexEscape;var getCutTerm=function(longWord,chunkExp){for(var cutTerms=longWord.match(chunkExp),i=cutTerms.length,oldFirst="",newFirst="",offenders=[".",":",";"];i--;
)newFirst=cutTerms[i].charAt(0),-1<offenders.indexOf(newFirst)&&(cutTerms[i]=cutTerms[i].substr(1)),-1<offenders.indexOf(oldFirst)&&(cutTerms[i]=cutTerms[i]+oldFirst),oldFirst=newFirst;return cutTerms.join(" ")};return function(str,threshold){str=str.toString().replace(/([\w])</g,"$1 <");for(var cut,chunkExp=new RegExp(".{1,"+threshold+"}","g"),longWords=str.match(new RegExp("[\\S]{"+threshold+",}","g"))||[],i=longWords.length;i--;)cut=getCutTerm(longWords[i],chunkExp),str=str.replace(new RegExp(regexEscape(longWords[i]),"g"),cut);return str}}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(
):"function"==typeof define&&define.amd?define("util/encode",factory):(global=global||self)["util/encode"]=factory()}(this,function(){"use strict";var _reQuot=/"/g,_reApos=/'/g,encodeHTML=function(html){return document.createElement("a").appendChild(document.createTextNode(html)).parentNode.innerHTML};return{html:encodeHTML,attribute:function(html){return encodeHTML(html).replace(_reQuot,"&quot;").replace(_reApos,"&apos;")},encodeBase64:function(str){return btoa(encodeURIComponent(str).replace(/%([0-9A-F]{2})/g,function(match,p1){return String.fromCharCode("0x"+p1)}))},decodeBase64:function(str){return decodeURIComponent(Array.prototype.map.call(atob(str),
function(c){return"%"+("00"+c.charCodeAt(0).toString(16)).slice(-2)}).join(""))}}}),define("tpl!taoSync/component/synchronization/detailedReport",["handlebars"],function(hb){return hb.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,options,buffer="",functionType="function",escapeExpression=this.escapeExpression,helperMissing=helpers.helperMissing;return buffer+='<div class="modal sync-report-modal">\n    <section>\n        <h1>\n            '+escapeExpression((options={hash:{},data:data},(helper=helpers.__||depth0&&depth0.__
)?helper.call(depth0,"Synchronization report data",options):helperMissing.call(depth0,"__","Synchronization report data",options)))+"\n        </h1>\n        ",!(stack1=helpers.each.call(depth0,depth0&&depth0.data,{hash:{},inverse:this.noop,fn:this.program(1,function(depth0,data){var stack1,buffer="";return buffer+="\n        <h2>"+escapeExpression(typeof(stack1=null==data||!1===data?data:data.key)===functionType?stack1.apply(depth0):stack1)+":</h2>\n        <div><pre>"+escapeExpression(typeof depth0===functionType?depth0.apply(depth0):depth0)+"</pre></div>\n        <hr>\n        "},data),data:data}))&&0!==stack1||(buffer+=stack1),
buffer+="\n    </section>\n</div>"})}),define("tpl!taoSync/component/synchronization/list",["handlebars"],function(hb){return hb.template(function(Handlebars,depth0,helpers,partials,data){return this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),{},'<div class="component results-list">\n    <div class="list"></div>\n</div>'})}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("jquery"),require("lodash")):"function"==typeof define&&define.amd?define("core/pluginifier",["jquery","lodash"],factory):(global=global||self)["core/pluginifier"]=factory(global.$,global._)}(this,
function($,_){"use strict";$=$&&$.hasOwnProperty("default")?$.default:$,_=_&&_.hasOwnProperty("default")?_.default:_;var basePlugin={options:function(dataNs,ns,options){return this.each(function(){var $elt=$(this),currentOptions=$elt.data(dataNs);currentOptions&&$elt.data(dataNs,_.merge(currentOptions,options))})},disable:function(dataNs,ns){return this.each(function(){var $elt=$(this),options=$elt.data(dataNs);options&&$elt.addClass(options.disableClass||"disabled").trigger("disable."+ns)})},enable:function(dataNs,ns){return this.each(function(){var $elt=$(this),options=$elt.data(dataNs);options&&$elt.removeClass(options.disableClass||"disabled").trigger(
"enable."+ns)})}};return{register:function(pluginName,plugin,config){var ns=(config=config||{}).ns||pluginName.toLowerCase(),dataNs=config.dataNs||"ui."+ns,expose=config.expose||[];return _.isFunction($.fn[pluginName])?$.error("A plugin named "+pluginName+" is already registered"):_.isPlainObject(plugin)&&_.isFunction(plugin.init)?(_.assign(plugin,_.transform(basePlugin,function(result,prop,key){_.isFunction(prop)&&(result[key]=_.partial(basePlugin[key],dataNs,ns))})),_.forEach(expose,function(toExposeName){var privateMethod=toExposeName,publicMethod=toExposeName;/^_/.test(expose)?publicMethod=publicMethod.replace(/^_/,""):privateMethod="_"+privateMethod,
_.isFunction(plugin[privateMethod])&&!_.isFunction(plugin[publicMethod])&&(plugin[publicMethod]=function(){var returnValue,args=Array.prototype.slice.call(arguments,0);return this.each(function(){returnValue=plugin[privateMethod].apply(plugin,[$(this)].concat(args))}),returnValue||this})}),void($.fn[pluginName]=function(method){if(plugin[method]){if(!/^_/.test(method))return plugin[method].apply(this,Array.prototype.slice.call(arguments,1));$.error("Trying to call a private method `"+method+"`")}else if("object"==typeof method||!method)return plugin.init.apply(this,arguments);$.error("Method "+method+" does not exist on plugin")})):$.error(
"The object to register as a jQuery plugin must be a plain object with an `init` method.")}}}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("lodash")):"function"==typeof define&&define.amd?define("core/providerRegistry",["lodash"],factory):(global=global||self)["core/providerRegistry"]=factory(global._)}(this,function(_){"use strict";return _=_&&_.hasOwnProperty("default")?_.default:_,function(target,validator){var _providers={};return(target=target||{}).registerProvider=function(name,provider){var valid=!0;if(!_.isString(name)||name.length<=0)throw new TypeError(
"It is required to give a name to your provider.");if(!_.isPlainObject(provider)||!_.isFunction(provider.init))throw new TypeError("A provider is an object that contains at least an init function.");return(valid=validator&&_.isFunction(validator)?validator(provider):valid)&&(_providers[name]=provider),this},target.getProvider=function(providerName){var provider;if(!_providers||0===_.size(_providers))throw new Error("No provider registered");if(_.isString(providerName)&&0<providerName.length?provider=_providers[providerName]:1===_.size(_providers)&&(providerName=_.keys(_providers)[0],provider=_providers[providerName]),!provider)throw new Error(
"No candidate found for the provider");return provider},target.getAvailableProviders=function(){return _.keys(_providers)},target.clearProviders=function(){return _providers={},this},target}}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("lodash")):"function"==typeof define&&define.amd?define("util/namespace",["lodash"],factory):(global=global||self)["util/namespace"]=factory(global._)}(this,function(_){"use strict";_=_&&_.hasOwnProperty("default")?_.default:_;var reSplit=/\s/g,namespaceHelper={split:function(names,normalize){return!_.isString(names)||_.isEmpty(names)?[]:(normalize&&(
names=names.toLowerCase()),_(names.trim().split(reSplit)).compact().uniq().value())},getName:function(namespaced){return!_.isString(namespaced)||_.isEmpty(namespaced)?"":-1<namespaced.indexOf(".")?namespaced.substr(0,namespaced.indexOf(".")):namespaced},getNamespace:function(namespaced,defaultNs){return!_.isString(namespaced)||_.isEmpty(namespaced)?"":-1<namespaced.indexOf(".")?namespaced.substr(namespaced.indexOf(".")+1):defaultNs||"@"},namespaceAll:function(names,namespace,normalize){var suffix;return _.isArray(names)||(names=namespaceHelper.split(names,normalize)),normalize&&(namespace=namespace.toLowerCase()),suffix=namespace?"."+namespace:"",_(names
).map(function(sh){return sh.indexOf(".")<0?sh+suffix:sh}).compact().uniq().value().join(" ")}};return namespaceHelper}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("jquery"),require("lodash"),require("util/namespace")):"function"==typeof define&&define.amd?define("util/shortcut/registry",["jquery","lodash","util/namespace"],factory):(global=global||self)["util/shortcut/registry"]=factory(global.$,global._,global["util/namespace"])}(this,function($,_,namespaceHelper){"use strict";$=$&&$.hasOwnProperty("default")?$.default:$,_=_&&_.hasOwnProperty("default")?_.default:_,
namespaceHelper=namespaceHelper&&namespaceHelper.hasOwnProperty("default")?namespaceHelper.default:namespaceHelper;var modifiers={ctrl:"ctrlKey",alt:"altKey",option:"altKey",shift:"shiftKey",meta:"metaKey",cmd:"metaKey",win:"metaKey"},translateKeys={escape:"esc",arrowdown:"down",arrowleft:"left",arrowright:"right",arrowup:"up"},specialKeys={8:"backspace",9:"tab",13:"enter",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"delete",91:"meta",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",
145:"scrolllock",144:"numlock"};function registerEvent(target,eventName,listener){target.addEventListener?target.addEventListener(eventName,listener,!1):target.attachEvent?target.attachEvent("on"+eventName,listener):target["on"+eventName]=listener}function unregisterEvent(target,eventName,listener){target.removeEventListener?target.removeEventListener(eventName,listener,!1):target.detachEvent?target.detachEvent("on"+eventName,listener):target["on"+eventName]=null}function normalizeCommand(descriptor){var key=translateKeys[descriptor.key]||descriptor.key,parts=[];return descriptor.ctrlKey&&parts.push("control"),descriptor.altKey&&parts.push("alt"),
descriptor.shiftKey&&parts.push("shift"),descriptor.metaKey&&parts.push("meta"),descriptor.scrollDown&&parts.push("scrollDown"),descriptor.scrollUp&&parts.push("scrollUp"),descriptor.clickLeft&&parts.push("clickLeft"),descriptor.clickRight&&parts.push("clickRight"),descriptor.clickMiddle&&parts.push("clickMiddle"),descriptor.clickBack&&parts.push("clickBack"),descriptor.clickForward&&parts.push("clickForward"),key&&parts.indexOf(key)<0&&parts.push(key),parts.join("+")}function parseCommand(shortcut){var parts=namespaceHelper.getName(shortcut).split("+"),descriptor={keyboardInvolved:!1,mouseClickInvolved:!1,mouseWheelInvolved:!1,ctrlKey:!1,altKey:!1,
shiftKey:!1,metaKey:!1,key:null,scrollUp:null,scrollDown:null,clickLeft:null,clickRight:null,clickMiddle:null,clickBack:null,clickForward:null};return _.forEach(parts,function(part){if(modifiers[part])descriptor[modifiers[part]]=!0;else if(0<=part.indexOf("mouse")){if(descriptor.keyboardInvolved)throw new Error("A shortcut cannot involve both mouse and regular keys!");0<=part.indexOf("scroll")&&(descriptor.mouseWheelInvolved=!0,descriptor.scrollUp=0<=part.indexOf("up"),descriptor.scrollDown=0<=part.indexOf("down")),0<=part.indexOf("click")&&(descriptor.mouseClickInvolved=!0,descriptor.clickLeft=0<=part.indexOf("left"),descriptor.clickRight=0<=part.indexOf(
"right"),descriptor.clickMiddle=0<=part.indexOf("middle"),descriptor.clickBack=0<=part.indexOf("back"),descriptor.clickForward=0<=part.indexOf("forward"))}else{if(descriptor.mouseClickInvolved||descriptor.mouseWheelInvolved)throw new Error("A shortcut cannot involve both mouse and regular keys!");descriptor.keyboardInvolved=!0,descriptor.key=part}}),descriptor}return function(root,defaultOptions){var keyboardIsRegistered=!1,mouseClickIsRegistered=!1,mouseWheelIsRegistered=!1,keyboardCount=0,mouseClickCount=0,mouseWheelCount=0,shortcuts={},handlers={},states={};function getHandlers(command,namespace){return handlers[namespace]=handlers[namespace]||{},
handlers[namespace][command]=handlers[namespace][command]||[],handlers[namespace][command]}function getCommandHandlers(command){return _.reduce(handlers,function(acc,nsHandlers){return nsHandlers[command]&&(acc=acc.concat(nsHandlers[command])),acc},[])}function setOptions(descriptor,options){descriptor.options=_.defaults(_.merge(descriptor.options||{},options),defaultOptions)}function unregisterKeyboard(){--keyboardCount<=0&&(keyboardCount=0,keyboardIsRegistered&&(unregisterEvent(root,"keydown",onKeyboard),keyboardIsRegistered=!1))}function unregisterMouseClick(){--mouseClickCount<=0&&(mouseClickCount=0,mouseClickIsRegistered&&(unregisterEvent(root,"click",
onMouseClick),mouseClickIsRegistered=!1))}function unregisterMouseWheel(){--mouseWheelCount<=0&&(mouseWheelCount=0,mouseWheelIsRegistered&&(unregisterEvent(root,"wheel",onMouseWheel),mouseWheelIsRegistered=!1))}function registerCommand(command,descriptor){(shortcuts[command]=descriptor).keyboardInvolved&&(keyboardIsRegistered||(registerEvent(root,"keydown",onKeyboard),keyboardIsRegistered=!0),keyboardCount++),descriptor.mouseClickInvolved&&(mouseClickIsRegistered||(registerEvent(root,"click",onMouseClick),mouseClickIsRegistered=!0),mouseClickCount++),descriptor.mouseWheelInvolved&&(mouseWheelIsRegistered||(registerEvent(root,"wheel",onMouseWheel),
mouseWheelIsRegistered=!0),mouseWheelCount++)}function onKeyboard(event){processShortcut(event,{keyboardInvolved:!0,ctrlKey:event.ctrlKey,altKey:event.altKey,shiftKey:event.shiftKey,metaKey:event.metaKey,key:function(event){var code=event.which||event.keyCode,character=32<=code?String.fromCharCode(code).toLowerCase():"",key=event.key&&event.key.toLowerCase(),keyName=event.code&&event.code.toLowerCase();return keyName&&(0===keyName.indexOf("key")?(key<"a"||"z"<key)&&"a"<=character&&character<="z"&&(key=character):0===keyName.indexOf("digit")&&(key=keyName.substr(5))),specialKeys[code]||key||character}(event)})}function onMouseClick(event){processShortcut(
event,_.merge({mouseClickInvolved:!0,ctrlKey:event.ctrlKey,altKey:event.altKey,shiftKey:event.shiftKey,metaKey:event.metaKey},function(event){var buttons={clickLeft:!1,clickRight:!1,clickMiddle:!1,clickBack:!1,clickForward:!1};if(event.buttons)buttons.clickLeft=!!(1&event.buttons),buttons.clickRight=!!(2&event.buttons),buttons.clickMiddle=!!(4&event.buttons),buttons.clickBack=!!(8&event.buttons),buttons.clickForward=!!(16&event.buttons);else switch(event.button){case 0:buttons.clickLeft=!0;break;case 1:buttons.clickMiddle=!0;break;case 2:buttons.clickRight=!0;break;case 3:buttons.clickBack=!0;break;case 4:buttons.clickForward=!0}return buttons}(event)))}
function onMouseWheel(event){processShortcut(event,_.merge({mouseClickInvolved:!0,ctrlKey:event.ctrlKey,altKey:event.altKey,shiftKey:event.shiftKey,metaKey:event.metaKey},function(event){return{scrollUp:event.deltaY<0,scrollDown:0<event.deltaY}}(event)))}function processShortcut(event,descriptor){var shortcutHandlers,$target,command=normalizeCommand(descriptor),shortcut=shortcuts[command];if(shortcut&&!states.disabled){if(!0===shortcut.options.avoidInput&&($target=$(event.target)).closest('[type="text"],textarea').length&&(!shortcut.options.allowIn||!$target.closest(shortcut.options.allowIn).length))return
;!1===shortcut.options.propagate&&event.stopPropagation(),!0===shortcut.options.prevent&&event.preventDefault(),(shortcutHandlers=getCommandHandlers(command))&&_.forEach(shortcutHandlers,function(handler){handler(event,command)})}}return root.jquery&&(root=root.get(0)),{set:function(shortcut,options){return _.forEach(namespaceHelper.split(shortcut,!0),function(normalized){var descriptor=parseCommand(normalized),command=normalizeCommand(descriptor);setOptions(descriptor,options),registerCommand(command,descriptor)}),this},add:function(shortcut,handler,options){return _.isFunction(handler)&&_.forEach(namespaceHelper.split(shortcut,!0),function(normalized){
var namespace=namespaceHelper.getNamespace(normalized,"*"),descriptor=parseCommand(normalized),command=normalizeCommand(descriptor);setOptions(descriptor,options),registerCommand(command,descriptor),getHandlers(command,namespace).push(handler)}),this},remove:function(shortcut){return _.forEach(namespaceHelper.split(shortcut,!0),function(normalized){var namespace=namespaceHelper.getNamespace(normalized,"*"),command=normalizeCommand(parseCommand(normalized));!function(command,namespace){namespace&&!command?handlers[namespace]={}:_.forEach(handlers,function(nsHandlers,ns){!nsHandlers[command]||"*"!==namespace&&namespace!==ns||(nsHandlers[command]=[])})}(command
,namespace),getCommandHandlers(command).length||function(command){var descriptor=shortcuts[command];shortcuts[command]=null,descriptor&&(descriptor.keyboardInvolved&&unregisterKeyboard(),descriptor.mouseClickInvolved&&unregisterMouseClick(),descriptor.mouseWheelInvolved&&unregisterMouseWheel())}(command)}),this},exists:function(shortcut){var normalized=String(shortcut).trim().toLowerCase(),namespace=namespaceHelper.getNamespace(normalized,"*"),command=normalizeCommand(parseCommand(normalized)),shortcutExists=!1;return shortcuts[command]?shortcutExists="*"===namespace||!!getHandlers(command,namespace).length:command||(shortcutExists=!_.isEmpty(
handlers[namespace])),shortcutExists},clear:function(){return shortcuts={},handlers={},mouseWheelCount=mouseClickCount=keyboardCount=0,unregisterKeyboard(),unregisterMouseClick(),unregisterMouseWheel(),this},getState:function(name){return!!states[name]},setState:function(name,state){return states[name]=!!state,this},enable:function(){return this.setState("disabled",!1),this},disable:function(){return this.setState("disabled",!0),this}}}}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("jquery"),require("lodash")):"function"==typeof define&&define.amd?define("core/dataattrhandler",["jquery",
"lodash"],factory):(global=global||self)["core/dataattrhandler"]=factory(global.$,global._)}(this,function($,_){"use strict";$=$&&$.hasOwnProperty("default")?$.default:$,_=_&&_.hasOwnProperty("default")?_.default:_;var defaults={container:!1,listenerEvent:"click",useTarget:!0,bubbled:!1},letDefaultOn=[":radio",":checkbox"],shouldPreventDefault=function($elt){return!$elt.is(letDefaultOn.join(","))},DataAttrHandler=function(attrName,options){var self=this;this.options=_.defaults(options,defaults);var selector="[data-"+attrName+"]";if(!_.has(this.options,"namespace")||!_.isString(this.options.namespace))return $.error(
"The plugin data namespace option is required");this.options.container&&this.options.container.selector&&(selector=this.options.container.selector+" "+selector),this.options.inner&&(selector+=" "+this.options.inner),$(document).off(this.options.listenerEvent,selector).on(this.options.listenerEvent,selector,function(e){var $target,$outer,$elt=$(e.target);!0!==self.options.bubbled&&!$elt.is(selector)||(void 0===$elt.data(attrName)&&(self.options.inner||self.options.bubbled)&&($elt=($outer=$elt).parents("[data-"+attrName+"]")),$target=!0===self.options.useTarget?DataAttrHandler.getTarget(attrName,$elt):self.options.inner?$outer:void 0,$elt.data(
self.options.namespace)||("function"==typeof self.createPlugin&&self.createPlugin($elt,$target),$elt.is(":radio")&&$elt.attr("name")&&$(':radio[name="'+$elt.attr("name")+'"]').not($elt).on(self.options.listenerEvent,function(e){"function"==typeof self.callPluginMethod&&self.callPluginMethod($elt,$target),shouldPreventDefault($elt)&&e.preventDefault()})),"function"==typeof self.callPluginMethod&&self.callPluginMethod($elt,$target),shouldPreventDefault($elt)&&e.preventDefault())})};return DataAttrHandler.prototype.init=function(cb){return this.createPlugin=cb,this},DataAttrHandler.prototype.trigger=function(cb){return this.callPluginMethod=cb,this},
DataAttrHandler.getTarget=function(attrName,$elt){var relativeRegex=/^(\+|>|~|:parent|<)/,$target=[],targetSelector=$elt.attr("data-"+attrName)||$elt.attr("href")||$elt.attr("attrName");if(!_.isEmpty(targetSelector)){var matches=relativeRegex.exec(targetSelector);if(null!==matches){var selector=targetSelector.replace(relativeRegex,"");$target=":parent"===matches[0]||"<"===matches[0]?$elt.parents(selector):"~"===matches[0]?$elt.siblings(selector):"+"===matches[0]?$elt.next(selector):$(selector,$elt)}else $target=$(targetSelector)}return $target},DataAttrHandler}),function(global,factory){
"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory():"function"==typeof define&&define.amd?define("util/httpErrorParser",factory):(global=global||self)["util/httpErrorParser"]=factory()}(this,function(){"use strict";return{parse:function(xhr,options,errorThrown){var msg,json,error;try{msg=(json=JSON.parse(xhr.responseText)).message?json.message:errorThrown}catch(e){msg=errorThrown}return(error=new Error(msg)).response=xhr,error.code=xhr.status,error.errorThrown=errorThrown,error}}}),define("taoSync/component/synchronization/list",["jquery","i18n","lodash","uri","core/promise","ui/component",
"tpl!taoSync/component/synchronization/list","ui/datatable"],function($,__,_,uri,Promise,component,listTpl){"use strict";return function(config){var syncHistoryList;if(!_.isPlainObject(config))throw new TypeError("The configuration is required");if(!_.isPlainObject(config.model)&&!_.isArray(config.model))throw new TypeError("The data model is required");return(syncHistoryList=component({})).on("render",function(){this.getElement().datatable({sortby:config.sortby,sortorder:config.sortorder,url:config.dataUrl,model:config.model,actions:config.actions})}).setTemplate(listTpl),syncHistoryList.init()}}),define("taoSync/controller/SynchronizationHistory/index",[
"jquery","lodash","i18n","module","core/logger","util/url","layout/actions/binder","layout/loading-bar","ui/feedback","tpl!taoSync/component/synchronization/detailedReport","taoSync/component/synchronization/list"],function($,_,__,module,loggerFactory,urlHelper,binder,loadingBar,feedback,layout,syncHistoryListFactory){"use strict";var $table,logger=loggerFactory("controller/SynchronizationHistory/index");function reportError(err){loadingBar.stop(),logger.error(err),err instanceof Error&&feedback().error(err.message)}function viewReport(rowId){loadingBar.start(),$.ajax({url:urlHelper.route("viewReport","SynchronizationHistory","taoSync",{id:rowId}),
type:"GET",success:function(result){"object"==typeof result&&null!==result&&Object.keys(result).forEach(function(key){"object"==typeof result[key]&&result[key],result[key]=JSON.stringify(result[key],null,1)});var $container=$(layout({data:result}));$("#sync-history").append($container),$container.modal({startClosed:!0,minWidth:450}),$container.modal("open"),loadingBar.stop()},error:function(xhr,err){var message=getRequestErrorMessage(xhr);feedback().error(message,{encodeHtml:!1}),loadingBar.stop()}})}return{start:function(){var config=module.config()||{},actions={view:{action:viewReport,id:"view",label:__("View"),title:__("Detail view"),icon:"view"}},
model=config.dataModel;model.data.transform=function(value,row){return value.replace(/\n/g,"<br />")};var listConfig={sortby:"created_at",sortorder:"desc",dataUrl:urlHelper.route("getHistory","SynchronizationHistory","taoSync",{}),model:model,actions:actions};($table=$("#sync-history")).length?(loadingBar.start(),syncHistoryListFactory(listConfig,actions).on("error",reportError).on("success",function(message){feedback().success(message)}).before("loading",function(){loadingBar.start()}).after("loaded",function(){loadingBar.stop()}).render($(".sync-history-grid",$table))):loadingBar.stop()}}}),function(global,factory){
"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("lodash"),require("core/promise"),require("core/eventifier"),require("lib/uuid")):"function"==typeof define&&define.amd?define("core/promiseQueue",["lodash","core/promise","core/eventifier","lib/uuid"],factory):(global=global||self)["core/promiseQueue"]=factory(global._,global["core/promise"],global["core/eventifier"],global["lib/uuid"])}(this,function(_,Promise,eventifier,uuid){"use strict";return _=_&&_.hasOwnProperty("default")?_.default:_,Promise=Promise&&Promise.hasOwnProperty("default")?Promise.default:Promise,eventifier=eventifier&&eventifier.hasOwnProperty("default"
)?eventifier.default:eventifier,uuid=uuid&&uuid.hasOwnProperty("default")?uuid.default:uuid,function(){function getId(){var id="promise-"+uuid(6);return void 0===queue[id]?id:getId()}var queue={};return{add:function(promise){return queue[getId()]=promise,this},getValues:function(){return _.values(queue)},clear:function(){return queue={},this},serie:function(promiseFn){var id=getId(),currentQueue=this.getValues(),emitter=eventifier();return queue[id]=new Promise(function(resolve){emitter.on("fulfilled",resolve)}),Promise.all(currentQueue).then(function(){if(_.isFunction(promiseFn))return promiseFn()}).then(function(data){return emitter.trigger("fulfilled"),
delete queue[id],data}).catch(function(err){throw queue={},err})}}}}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("lodash"),require("core/promise"),require("core/promiseQueue"),require("lib/uuid")):"function"==typeof define&&define.amd?define("core/store/localstorage",["lodash","core/promise","core/promiseQueue","lib/uuid"],factory):(global=global||self)["core/store/localstorage"]=factory(global._,global["core/promise"],global["core/promiseQueue"],global["lib/uuid"])}(this,function(_,Promise,promiseQueue,uuid){"use strict";_=_&&_.hasOwnProperty("default")?_.default:_,
Promise=Promise&&Promise.hasOwnProperty("default")?Promise.default:Promise,promiseQueue=promiseQueue&&promiseQueue.hasOwnProperty("default")?promiseQueue.default:promiseQueue,uuid=uuid&&uuid.hasOwnProperty("default")?uuid.default:uuid;var storage=window.localStorage,writingQueue=promiseQueue(),setEntry=function(storeName,key,value){return new Promise(function(resolve,reject){try{storage.setItem("tao-store-"+storeName+"."+key,JSON.stringify(value)),resolve(!0)}catch(ex){reject(ex)}})},getEntry=function(storeName,key){return new Promise(function(resolve,reject){var value;try{null===(value=storage.getItem("tao-store-"+storeName+"."+key))?resolve():resolve(
JSON.parse(value))}catch(ex){reject(ex)}})},getKnownStores=function(){return getEntry("index","stores")},localStorageBackend=function(storeName){var name,registered=!1,openStore=function(){return registered?Promise.resolve():function(storeName){return getKnownStores().then(function(stores){return(stores=stores||{})[storeName]={name:storeName,lastOpen:Date.now()},setEntry("index","stores",stores)})}(storeName).then(function(){registered=!0})};if(_.isEmpty(storeName)||!_.isString(storeName))throw new TypeError("The store name is required");return name="tao-store-"+storeName+".",{getItem:function(key){return writingQueue.serie(function(){return openStore(
).then(function(){return getEntry(storeName,key)})})},setItem:function(key,value){return writingQueue.serie(function(){return openStore().then(function(){return setEntry(storeName,key,value)})})},removeItem:function(key){return writingQueue.serie(function(){return openStore().then(function(){return storage.removeItem(name+key),!0})})},getItems:function(){var keyPattern=new RegExp("^"+name);return writingQueue.serie(function(){return openStore().then(function(){return _(storage).map(function(entry,index){return storage.key(index)}).filter(function(key){return keyPattern.test(key)}).reduce(function(acc,key){var value,exposedKey=key.replace(name,"");try{
null!==(value=storage.getItem(key))&&(acc[exposedKey]=JSON.parse(value))}catch(ex){acc[exposedKey]=null}return acc},{})})})},clear:function(){var keyPattern=new RegExp("^"+name);return writingQueue.serie(function(){return openStore().then(function(){return _(storage).map(function(entry,index){return storage.key(index)}).filter(function(key){return keyPattern.test(key)}).forEach(function(key){storage.removeItem(key)}),!0})})},removeStore:function(){return this.clear().then(function(){return function(storeName){return getKnownStores().then(function(stores){return delete(stores=stores||{})[storeName],setEntry("index","stores",stores)})}(storeName)})}}}
;return localStorageBackend.removeAll=function(validate){return _.isFunction(validate)||(validate=null),getKnownStores().then(function(stores){var removing=_(stores).filter(function(store,storeName){return!validate||validate(storeName,store)}).map(function(store){return store&&store.name?localStorageBackend(store.name).removeStore():Promise.resolve()}).value();return Promise.all(removing)})},localStorageBackend.getAll=function(validate){return getKnownStores().then(function(stores){return _(stores).filter(function(store,storeName){return!validate||validate(storeName,store)}).map(function(store){return store.name}).value()})},
localStorageBackend.getStoreIdentifier=function(){var idStore=localStorageBackend("id");return idStore.getItem("id").then(function(id){return _.isEmpty(id)?(id=uuid(),idStore.setItem("id",id).then(function(){return id})):id})},localStorageBackend}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("lodash"),require("core/promise"),require("lib/store/idbstore"),require("lib/uuid")):"function"==typeof define&&define.amd?define("core/store/indexeddb",["lodash","core/promise","lib/store/idbstore","lib/uuid"],factory):(global=global||self)["core/store/indexeddb"]=factory(global._,global["core/promise"],
global["lib/store/idbstore"],global["lib/uuid"])}(this,function(_,Promise,IDBStore,uuid){"use strict";_=_&&_.hasOwnProperty("default")?_.default:_,Promise=Promise&&Promise.hasOwnProperty("default")?Promise.default:Promise,IDBStore=IDBStore&&IDBStore.hasOwnProperty("default")?IDBStore.default:IDBStore,uuid=uuid&&uuid.hasOwnProperty("default")?uuid.default:uuid;var knownStores,isIndexedDB2="getAll"in IDBObjectStore.prototype,openStore=function(storeName){return new Promise(function(resolve,reject){var store=new IDBStore({dbVersion:1,storeName:storeName,storePrefix:"tao-store-",keyPath:"key",autoIncrement:!0,onStoreReady:function(){
store.db.onversionchange=function(e){e&&e.newVersion||store.db.close()},resolve(store)},onError:reject})})},setEntry=function(store,key,value){return new Promise(function(resolve,reject){var entry={key:key,value:value};store.put(entry,function(returnKey){resolve(returnKey===key)},reject)})},getEntry=function(store,key){return new Promise(function(resolve,reject){store.get(key,function(entry){if(!entry||void 0===entry.value)return resolve(entry);resolve(entry.value)},reject)})},removeEntry=function(store,key){return new Promise(function(resolve,reject){store.remove(key,function(result){resolve(!1!==result)},reject)})},getKnownStores=function(){
return knownStores=knownStores||openStore("index")},deleteStore=function(store,storeName){return new Promise(function(resolve,reject){var success=function(){(function(storeName){return getKnownStores().then(function(store){return removeEntry(store,storeName)})})(storeName).then(function(){resolve(!0)}).catch(reject)};isIndexedDB2?store.deleteDatabase(success,reject):store.clear(success,reject)})},indexDbBackend=function(storeName){var innerStore,writePromise,getStore=function(){return innerStore=innerStore||openStore(storeName).then(function(store){return function(storeName){return getKnownStores().then(function(store){return setEntry(store,storeName,{
name:storeName,lastOpen:Date.now()})})}(storeName).then(function(){return Promise.resolve(store)})})},ensureSerie=function(getWritingPromise){return writePromise?new Promise(function(resolve,reject){function runWrite(){var p=getWritingPromise();(writePromise=p).then(resolve).catch(reject)}writePromise.then(runWrite).catch(runWrite)}):writePromise=getWritingPromise()};if(_.isEmpty(storeName)||!_.isString(storeName))throw new TypeError("The store name is required");return{getItem:function(key){return ensureSerie(function(){return getStore().then(function(store){return getEntry(store,key)})})},setItem:function(key,value){return ensureSerie(function(){
return getStore().then(function(store){return setEntry(store,key,value)})})},removeItem:function(key){return ensureSerie(function(){return getStore().then(function(store){return removeEntry(store,key)})})},getItems:function(){return ensureSerie(function(){return getStore().then(function(store){return function(store){return new Promise(function(resolve,reject){store.getAll(function(entries){if(!_.isArray(entries))return resolve({});resolve(_.reduce(entries,function(acc,entry){return entry.key&&entry.value&&(acc[entry.key]=entry.value),acc},{}))},reject)})}(store)})})},clear:function(){return ensureSerie(function(){return getStore().then(function(store){
return new Promise(function(resolve,reject){store.clear(function(){resolve(!0)},reject)})})})},removeStore:function(){return ensureSerie(function(){return getStore().then(function(store){return deleteStore(store,storeName)})})}}};return indexDbBackend.removeAll=function(validate){return _.isFunction(validate)||(validate=null),getKnownStores().then(function(store){return new Promise(function(resolve,reject){store.getAll(function(entries){var all=[];_.forEach(entries,function(entry){var storeName=entry&&entry.key;storeName&&all.push(openStore(storeName).then(function(storeToRemove){if(!validate||validate(storeName,entry.value))return deleteStore(storeToRemove,
storeName)}))}),Promise.all(all).then(resolve).catch(reject)},reject)})})},indexDbBackend.getAll=function(validate){return _.isFunction(validate)||(validate=function(){return!0}),getKnownStores().then(function(store){return new Promise(function(resolve,reject){store.getAll(function(entries){var storeNames=_(entries).filter(function(entry){return entry&&entry.key&&validate(entry.key,entry.value)}).map(function(entry){return entry.key}).value();return resolve(storeNames)},reject)})})},indexDbBackend.getStoreIdentifier=function(){return openStore("id").then(function(store){return getEntry(store,"id").then(function(id){return _.isEmpty(id)?(id=uuid(),setEntry(
store,"id",id).then(function(){return id})):id})})},indexDbBackend}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("lodash"),require("core/promise"),require("lib/uuid")):"function"==typeof define&&define.amd?define("core/store/memory",["lodash","core/promise","lib/uuid"],factory):(global=global||self)["core/store/memory"]=factory(global._,global["core/promise"],global["lib/uuid"])}(this,function(_,Promise,uuid){"use strict";_=_&&_.hasOwnProperty("default")?_.default:_,Promise=Promise&&Promise.hasOwnProperty("default")?Promise.default:Promise,uuid=uuid&&uuid.hasOwnProperty("default"
)?uuid.default:uuid;var idStore,memoryStore={},memoryStorageBackend=function(storeName){if(_.isEmpty(storeName)||!_.isString(storeName))throw new TypeError("The store name is required");return memoryStore[storeName]=memoryStore[storeName]||{},{getItem:function(key){return _.isPlainObject(memoryStore[storeName])?Promise.resolve(memoryStore[storeName][key]):Promise.resolve()},setItem:function(key,value){return _.isPlainObject(memoryStore[storeName])||(memoryStore[storeName]={}),memoryStore[storeName][key]=value,Promise.resolve(!0)},removeItem:function(key){return memoryStore[storeName]=_.omit(memoryStore[storeName],key),Promise.resolve(
void 0===memoryStore[storeName][key])},getItems:function(){return Promise.resolve(memoryStore[storeName])},clear:function(){return memoryStore[storeName]={},Promise.resolve(!0)},removeStore:function(){return memoryStore=_.omit(memoryStore,storeName),Promise.resolve(void 0===memoryStore[storeName])}}};return memoryStorageBackend.removeAll=function(validate){return _.isFunction(validate)||(validate=null),memoryStore=_.omit(memoryStore,function(store,storeName){return!validate||validate(storeName)}),Promise.resolve(!0)},memoryStorageBackend.getAll=function(validate){var storeNames;return _.isFunction(validate)||(validate=null),storeNames=_(memoryStore).map(
function(store,storeName){return storeName}).filter(function(storeName){return!validate||validate(storeName)}).value(),Promise.resolve(storeNames)},memoryStorageBackend.getStoreIdentifier=function(){return _.isEmpty(idStore)&&(idStore=uuid()),Promise.resolve(idStore)},memoryStorageBackend}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("lodash"),require("moment"),require("module"),require("core/logger"),require("core/promise"),require("core/store/localstorage"),require("core/store/indexeddb"),require("core/store/memory")):"function"==typeof define&&define.amd?define("core/store",["lodash",
"moment","module","core/logger","core/promise","core/store/localstorage","core/store/indexeddb","core/store/memory"],factory):(global=global||self)["core/store"]=factory(global._,global.moment,global.module,global["core/logger"],global["core/promise"],global["core/store/localstorage"],global["core/store/indexeddb"],global["core/store/memory"])}(this,function(_,moment,module,loggerFactory,Promise,localStorageBackend,indexedDBBackend,memoryBackend){"use strict";_=_&&_.hasOwnProperty("default")?_.default:_,moment=moment&&moment.hasOwnProperty("default")?moment.default:moment,module=module&&module.hasOwnProperty("default")?module.default:module,
loggerFactory=loggerFactory&&loggerFactory.hasOwnProperty("default")?loggerFactory.default:loggerFactory,Promise=Promise&&Promise.hasOwnProperty("default")?Promise.default:Promise,localStorageBackend=localStorageBackend&&localStorageBackend.hasOwnProperty("default")?localStorageBackend.default:localStorageBackend,indexedDBBackend=indexedDBBackend&&indexedDBBackend.hasOwnProperty("default")?indexedDBBackend.default:indexedDBBackend,memoryBackend=memoryBackend&&memoryBackend.hasOwnProperty("default")?memoryBackend.default:memoryBackend;var store,supportsIndexedDB=!1,dectectionDone=!1,quotaChecked=!1,backendApi=["removeAll","getAll","getStoreIdentifier"],
storeApi=["getItem","setItem","removeItem","getItems","clear","removeStore"],logger=loggerFactory("core/store"),config=_.defaults(module.config()||{},{lowSpaceRatio:80,invalidation:{staled:"P2W",oldster:"P2M"}}),isIndexDBSupported=function(){return dectectionDone?Promise.resolve(supportsIndexedDB):new Promise(function(resolve){var test,indexedDB,done=function(result){return dectectionDone=!0,resolve(supportsIndexedDB=!!result)};try{if(!(indexedDB=window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.OIndexedDB||window.msIndexedDB))return done(!1);(test=indexedDB.open("__feature_test",1)).onsuccess=function(){if(test.result
)return test.result.close(),done(!0)},test.onerror=function(e){return e.preventDefault(),done(!1),!1}}catch(err){done(!1)}})},loadBackend=function(preselectedBackend){return isIndexDBSupported().then(function(){var backend=preselectedBackend||(supportsIndexedDB?indexedDBBackend:localStorageBackend);return _.isFunction(backend)?function(backend){return _.all(backendApi,function(method){return _.isFunction(backend[method])})}(backend)?(backend!==memoryBackend&&(!quotaChecked&&"storage"in window.navigator&&window.navigator.storage.estimate&&window.navigator.storage.estimate().then(function(estimate){var usedRatio=0;_.isNumber(estimate.usage)&&_.isNumber(
estimate.quota)&&0<estimate.quota&&((usedRatio=estimate.usage/estimate.quota)>config.lowSpaceRatio?(logger.warn("The browser storage is getting low "+usedRatio.toFixed(2)+"% used",estimate),logger.warn("We will attempt to clean oldster databases in persistent backends"),store.cleanUpSpace(config.invalidation.oldster,[],localStorageBackend),store.cleanUpSpace(config.invalidation.oldster,[],indexedDBBackend)):logger.debug("Browser storage estimate : "+usedRatio.toFixed(2)+"% used",estimate))}).catch(function(err){logger.warn("Unable to retrieve quotas : "+err.message)}),quotaChecked=!0),backend):Promise.reject(new TypeError(
"This backend doesn't comply with the store backend API")):Promise.reject(new TypeError("No backend, no storage!"))})};return(store=function(storeName,preselectedBackend){return loadBackend(preselectedBackend).then(function(backend){var storeInstance=backend(storeName);return function(storage){return _.all(storeApi,function(method){return _.isFunction(storage[method])})}(storeInstance)?storeInstance:Promise.reject(new TypeError("The store doesn't comply with the Storage interface"))})}).backends={localStorage:localStorageBackend,indexedDB:indexedDBBackend,memory:memoryBackend},store.removeAll=function(validate,preselectedBackend){return loadBackend(
preselectedBackend).then(function(backend){return backend.removeAll(validate)})},store.cleanUpSpace=function(since,storeNamePattern,preselectedBackend){var tsThreshold;return tsThreshold=_.isNumber(since)&&0<since?since:(_.isString(since)||(since=config.invalidation.oldster),moment().subtract(moment.duration(since)).valueOf()),logger.info("Trying to remove stores lastly opened before "+tsThreshold+"("+since+")"),store.removeAll(function(storeName,storeEntry){return!(!storeName||!storeEntry)&&(!(storeNamePattern instanceof RegExp&&!storeNamePattern.test(storeName))&&(_.isNumber(storeEntry.lastOpen)&&_.isNumber(tsThreshold)&&storeEntry.lastOpen<=tsThreshold))}
,preselectedBackend)},store.getAll=function(validate,preselectedBackend){return loadBackend(preselectedBackend).then(function(backend){return backend.getAll(validate)})},store.getIdentifier=function(preselectedBackend){return loadBackend(preselectedBackend).then(function(backend){return backend.getStoreIdentifier()})},store}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("lodash"),require("core/promise"),require("core/store")):"function"==typeof define&&define.amd?define("core/tokenStore",["lodash","core/promise","core/store"],factory):(global=global||self)["core/tokenStore"]=factory(global._,
global["core/promise"],global["core/store"])}(this,function(_,Promise,store){"use strict";_=_&&_.hasOwnProperty("default")?_.default:_,Promise=Promise&&Promise.hasOwnProperty("default")?Promise.default:Promise,store=store&&store.hasOwnProperty("default")?store.default:store;var defaultConfig={maxSize:6,tokenTimeLimit:144e4};return function(options){var config=_.defaults(options||{},defaultConfig),getStore=function(){return store("tokenStore.tokens",store.backends.memory)};return{dequeue:function(){var self=this;return self.getIndex().then(function(latestIndex){var key=_.first(latestIndex);return key?getStore().then(function(storage){return storage.getItem(
key)}).then(function(token){return self.remove(key).then(function(){return token})}):Promise.resolve()})},enqueue:function(token){var self=this;return _.isString(token)&&(token={value:token,receivedAt:Date.now()}),getStore().then(function(storage){return storage.setItem(token.value,token)}).then(function(updated){return!!updated&&self.enforceMaxSize().then(function(){return!0})})},getIndex:function(){return this.getTokens().then(function(tokens){return _.chain(tokens).values().sort(function(t1,t2){return t1.receivedAt-t2.receivedAt}).map("value").value()})},has:function(key){return this.getIndex().then(function(latestIndex){return _.contains(latestIndex,key)
})},remove:function(key){return this.has(key).then(function(result){return!!result&&getStore().then(function(storage){return storage.removeItem(key)})})},clear:function(){return getStore().then(function(storage){return storage.clear()})},getTokens:function(){return getStore().then(function(storage){return storage.getItems()})},getSize:function(){return this.getIndex().then(function(latestIndex){return latestIndex.length})},setMaxSize:function(size){_.isNumber(size)&&0<size&&size!==config.maxSize&&(config.maxSize=size,this.enforceMaxSize())},enforceMaxSize:function(){var self=this;return this.getIndex().then(function(latestIndex){var keysToRemove,
excess=latestIndex.length-config.maxSize;return!(0<excess)||(keysToRemove=latestIndex.slice(0,excess),Promise.all(_.map(keysToRemove,function(key){return self.remove(key)})))})},checkExpiry:function(token){return!(Date.now()-token.receivedAt>config.tokenTimeLimit)||this.remove(token.value)},expireOldTokens:function(){var self=this;return self.getTokens().then(function(tokens){return _.reduce(tokens,function(previousPromise,nextToken){return previousPromise.then(function(){return self.checkExpiry(nextToken)})},Promise.resolve()).then(function(){return!0})})}}}}),function(global,factory){
"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("lodash"),require("module"),require("core/tokenStore"),require("core/promise"),require("core/promiseQueue")):"function"==typeof define&&define.amd?define("core/tokenHandler",["lodash","module","core/tokenStore","core/promise","core/promiseQueue"],factory):(global=global||self)["core/tokenHandler"]=factory(global._,global.module,global["core/tokenStore"],global["core/promise"],global["core/promiseQueue"])}(this,function(_,module,tokenStoreFactory,Promise,promiseQueue){"use strict";_=_&&_.hasOwnProperty("default")?_.default:_,module=module&&module.hasOwnProperty("default"
)?module.default:module,tokenStoreFactory=tokenStoreFactory&&tokenStoreFactory.hasOwnProperty("default")?tokenStoreFactory.default:tokenStoreFactory,Promise=Promise&&Promise.hasOwnProperty("default")?Promise.default:Promise,promiseQueue=promiseQueue&&promiseQueue.hasOwnProperty("default")?promiseQueue.default:promiseQueue;var clientConfigFetched=!1,defaults={maxSize:6,tokenTimeLimit:144e4};return function(options){var tokenStore;return _.isString(options)&&(options={initialToken:options}),options=_.defaults({},options,defaults),tokenStore=tokenStoreFactory(options),{getToken:function(){var self=this,initialToken=options.initialToken,
getFirstTokenValue=function(){return tokenStore.dequeue().then(function(currentToken){return currentToken?currentToken.value:null})};return initialToken?(options.initialToken=null,Promise.resolve(initialToken)):tokenStore.expireOldTokens().then(function(){return tokenStore.getSize()}).then(function(queueSize){return 0<queueSize?getFirstTokenValue():clientConfigFetched?Promise.reject(new Error("No tokens available. Please refresh the page.")):self.getClientConfigTokens().then(getFirstTokenValue)})},setToken:function(newToken){return tokenStore.enqueue(newToken)},getClientConfigTokens:function(){var self=this,clientTokens=_.map(module.config().tokens,function(
serverToken){return{value:serverToken,receivedAt:Date.now()}});return clientConfigFetched=!0,Promise.resolve(clientTokens).then(function(newTokens){var setTokenQueue=promiseQueue();return _.forEach(newTokens,function(token){setTokenQueue.serie(function(){return self.setToken(token)})}),setTokenQueue.serie(function(){return!0})})},clearStore:function(){return tokenStore.clear()},getQueueLength:function(){return tokenStore.getSize()},setMaxSize:function(size){tokenStore.setMaxSize(size)}}}}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("jquery"),require("lodash"),require("i18n"),require("module"),
require("context"),require("core/promise"),require("core/promiseQueue"),require("core/tokenHandler"),require("core/logger")):"function"==typeof define&&define.amd?define("core/request",["jquery","lodash","i18n","module","context","core/promise","core/promiseQueue","core/tokenHandler","core/logger"],factory):(global=global||self)["core/request"]=factory(global.$,global._,global.__,global.module,global.context,global["core/promise"],global["core/promiseQueue"],global["core/tokenHandler"],global["core/logger"])}(this,function($,_,__,module,context,Promise,promiseQueue,tokenHandlerFactory,loggerFactory){"use strict";$=$&&$.hasOwnProperty("default")?$.default:$,
_=_&&_.hasOwnProperty("default")?_.default:_,__=__&&__.hasOwnProperty("default")?__.default:__,module=module&&module.hasOwnProperty("default")?module.default:module,context=context&&context.hasOwnProperty("default")?context.default:context,Promise=Promise&&Promise.hasOwnProperty("default")?Promise.default:Promise,promiseQueue=promiseQueue&&promiseQueue.hasOwnProperty("default")?promiseQueue.default:promiseQueue,tokenHandlerFactory=tokenHandlerFactory&&tokenHandlerFactory.hasOwnProperty("default")?tokenHandlerFactory.default:tokenHandlerFactory,loggerFactory=loggerFactory&&loggerFactory.hasOwnProperty("default")?loggerFactory.default:loggerFactory
;var tokenHandler=tokenHandlerFactory(),queue=promiseQueue(),logger=loggerFactory("core/request"),createError=function(response,fallbackMessage,httpCode,httpSent){var err;return(err=response&&response.errorCode?new Error(response.errorCode+" : "+(response.errorMsg||response.errorMessage||response.error)):new Error(fallbackMessage)).response=response,err.sent=httpSent,httpCode&&(err.code=httpCode),err};return function(options){if(module.config().noToken&&(options.noToken=!0),_.isEmpty(options.url))throw new TypeError("At least give a URL...");function runRequest(){var headers,setTokenFromXhr=function(xhr){var token;return _.isFunction(xhr.getResponseHeader
)&&(token=xhr.getResponseHeader("X-CSRF-Token"),logger.debug("received %s header %s","X-CSRF-Token",token),token)?tokenHandler.setToken(token):Promise.resolve()};return(headers=_.extend({},options.headers),options.noToken?Promise.resolve(headers):tokenHandler.getToken().then(function(token){return headers["X-CSRF-Token"]=token||"none",headers})).then(function(customHeaders){return new Promise(function(resolve,reject){$.ajax({url:options.url,method:options.method||"GET",headers:customHeaders,data:options.data,contentType:options.contentType||void 0,dataType:options.dataType||"json",async:!0,timeout:1e3*options.timeout||1e3*context.timeout||0,
beforeSend:function(){_.isEmpty(customHeaders)||logger.debug("sending %s header %s","X-CSRF-Token",customHeaders&&customHeaders["X-CSRF-Token"])},global:!options.background}).done(function(response,status,xhr){setTokenFromXhr(xhr).then(function(){return 204===xhr.status||response&&204===response.errorCode||"nocontent"===status?resolve():403===xhr.status||response&&403===response.errorCode?reject(createError(response,xhr.status+" : "+xhr.statusText,xhr.status,0<xhr.readyState)):200===xhr.status||response&&!0===response.success?resolve(response):void reject(createError(response,__("The server has sent an empty response"),xhr.status,0<xhr.readyState))}).catch(
function(error){logger.error(error),reject(createError(response,error,xhr.status,0<xhr.readyState))})}).fail(function(xhr,textStatus,errorThrown){var response;try{response=JSON.parse(xhr.responseText)}catch(parseErr){response=xhr.responseText}response=_.defaults(response,{success:!1,source:"network",cause:options.url,purpose:"proxy",context:this,code:xhr.status,sent:0<xhr.readyState,type:"error",message:errorThrown||__("An error occurred!")}),setTokenFromXhr(xhr).then(function(){reject(createError(response,xhr.status+" : "+xhr.statusText,xhr.status,0<xhr.readyState))}).catch(function(error){logger.error(error),reject(createError(response,error,xhr.status,
0<xhr.readyState))})})})})}return tokenHandler.getQueueLength().then(function(queueLength){return!0===options.noToken?runRequest():options.sequential||1===queueLength?queue.serie(runRequest):runRequest()})}}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("lodash"),require("core/request")):"function"==typeof define&&define.amd?define("core/dataProvider/request",["lodash","core/request"],factory):(global=global||self)["core/dataProvider/request"]=factory(global._,global["core/request"])}(this,function(_,coreRequest){"use strict";return _=_&&_.hasOwnProperty("default")?_.default:_,
coreRequest=coreRequest&&coreRequest.hasOwnProperty("default")?coreRequest.default:coreRequest,function(url,data,method,headers,background,noToken){return coreRequest({url:url,data:data,method:method,headers:headers,background:background,noToken:!1!==noToken}).then(function(response){return _.isUndefined(response)?Promise.resolve():response.success?Promise.resolve(response.data):Promise.reject(response)}).catch(function(error){return Promise.reject(error)})}}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("lodash"),require("core/promise"),require("core/eventifier")
):"function"==typeof define&&define.amd?define("core/polling",["lodash","core/promise","core/eventifier"],factory):(global=global||self)["core/polling"]=factory(global._,global["core/promise"],global["core/eventifier"])}(this,function(_,Promise,eventifier){"use strict";_=_&&_.hasOwnProperty("default")?_.default:_,Promise=Promise&&Promise.hasOwnProperty("default")?Promise.default:Promise,eventifier=eventifier&&eventifier.hasOwnProperty("default")?eventifier.default:eventifier;return function(config,argument_1){var timer,promise,interval,max,iter,action,context,autoStart,state={},startTimer=function(){timer=setTimeout(iteration,interval),state.stopped=!1,
state.pending=!0},stopTimer=function(){clearTimeout(timer),timer=null,state.stopped=!0,state.pending=!1},iteration=function(){max&&max<=iter?polling.stop():(iter=(iter||0)+1,state.processing=!0,state.pending=!1,polling.trigger("call"),action.call(context,polling),promise||state.stopped||(state.processing=!1,startTimer()))},polling={async:function(){var resolver={};return(promise=new Promise(function(resolve,reject){resolver.resolve=resolve,resolver.reject=reject})).then(function(){promise=null,state.processing=!1,state.stopped||startTimer(),polling.trigger("resolved")}).catch(function(){promise=null,state.processing=!1,polling.stop(),polling.trigger(
"rejected")}),polling.trigger("async",resolver),resolver},next:function(){var _next;return state.stopped&&(iter=0),stopTimer(),max&&max<=iter||(state.stopped=!1,promise?(_next=this.next.bind(this),promise.then(_next).catch(_next)):(this.trigger("next"),iteration())),this},start:function(){return timer||(iter=0,startTimer(),this.trigger("start")),this},stop:function(){return stopTimer(),this.trigger("stop"),this},setInterval:function(value){return interval=Math.abs(parseInt(value,10)||6e4),this.trigger("setinterval",interval),this},getInterval:function(){return interval},setAction:function(fn){return action=fn,this.trigger("setaction",action),this},
getAction:function(){return action},setContext:function(ctx){return context=ctx||this,this.trigger("setcontext",ctx),this},getContext:function(){return context},setMax:function(value){return max=Math.abs(parseInt(value,10)||0),this},getMax:function(){return max},getIteration:function(){return iter||0},is:function(stateName){return!!state[stateName]}};return eventifier(polling),interval=6e4,context=polling,action=null,autoStart=!(state.stopped=!0),iter=0,_.isFunction(config)&&(polling.setAction(config),config=null),_.isObject(config)&&(polling.setAction(config.action),polling.setInterval(config.interval||argument_1),polling.setContext(config.context),
polling.setMax(config.max),autoStart=!!config.autoStart),autoStart&&polling.start(),polling}}),define("tpl!taoSync/component/terminateExecutions/notification",["handlebars"],function(hb){return hb.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,options,buffer="",functionType="function",escapeExpression=this.escapeExpression,helperMissing=helpers.helperMissing
;return buffer+='<div class="component termination-area">\n    <section class="fb-container">\n        <div class="feedback-warning status-active">\n            <span class="icon-warning"></span>\n            <div class="notification-message">\n                <p>\n                    ',stack1=(helper=helpers.notificationMessage)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.notificationMessage)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+'\n                </p>\n            </div>\n\n            <div class="in-progress-list">\n                <p class="b">'+escapeExpression((options={
hash:{},data:data},(helper=helpers.__||depth0&&depth0.__)?helper.call(depth0,"Assessments in progress:",options):helperMissing.call(depth0,"__","Assessments in progress:",options)))+"</p>\n                <ul>\n                    ",!(stack1=helpers.each.call(depth0,depth0&&depth0.aggregatedData,{hash:{},inverse:this.noop,fn:this.program(1,function(depth0,data){var stack1,buffer="";return buffer+="\n                        <li>- "+escapeExpression(typeof(stack1=depth0&&depth0.label)===functionType?stack1.apply(depth0):stack1)+" / "+escapeExpression(typeof(stack1=depth0&&depth0.total)===functionType?stack1.apply(depth0):stack1)+"</li>\n                    "},
data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+='\n                </ul>\n            </div>\n        </div>\n\n\n        <div class="button-area">\n            <span class="btn-info cancel-button">\n                <span class="icon-close"></span>\n                '+escapeExpression((options={hash:{},data:data},(helper=helpers.__||depth0&&depth0.__)?helper.call(depth0,"Cancel",options):helperMissing.call(depth0,"__","Cancel",options)))+'\n            </span>\n\n            <span class="btn-warning force-terminate-button">\n                <span class="icon-warning"></span>\n                '+escapeExpression((options={hash:{},data:data},(
helper=helpers.__||depth0&&depth0.__)?helper.call(depth0,"Force end and synchronize",options):helperMissing.call(depth0,"__","Force end and synchronize",options)))+"\n            </span>\n        </div>\n    <div>\n</div>"})}),define("taoSync/component/terminateExecutions/terminateExecutions",["i18n","lodash","core/dataProvider/request","ui/component","tpl!taoSync/component/terminateExecutions/notification"],function(__,_,request,component,listTpl){"use strict";return function($container,config){if(!_.isPlainObject(config))throw new TypeError("The configuration is required");if(null==config.terminateUrl)throw new TypeError(
"terminateUrl configuration parameter is required");if(null==config.csrfToken)throw new TypeError("CSRF token is missing");return component({}).setTemplate(listTpl).on("init",function(){config.activeExecutions=[],config.aggregatedData={},config.notificationMessage=(1<config.data.length?__("There are %s assessments in progress",config.data.length):__("There is one assessment in progress"))+", "+__("please ensure that everyone has completed the assessment before proceeding."),_.forEach(config.data,function(execution){config.activeExecutions.push(execution.execution_id),config.aggregatedData[execution.context_id]=config.aggregatedData[execution.context_id]||{
total:0},config.aggregatedData[execution.context_id].label=execution.label,config.aggregatedData[execution.context_id].total++}),this.config=config}).on("render",function(){var self=this;$container.find(".cancel-button").on("click",function(e){e.preventDefault(),self.trigger("terminationCanceled"),self.destroy()}),$container.find(".force-terminate-button").on("click",function(e){e.preventDefault(),function(){var requestData={executionsId:config.activeExecutions};return requestData[config.csrfToken.name]=config.csrfToken.token,request(config.terminateUrl,requestData,"POST")}().then(function(response){self.trigger("terminationSucceeded"),self.destroy()}
).catch(function(error){self.trigger("terminationFailed")})}),self.trigger("dialogRendered")}).init(config)}}),define("taoSync/component/readinessDashboard/readinessDashboard",["i18n","lodash","core/eventifier","core/promise","ui/dashboard","core/dataProvider/request","util/url"],function(__,_,eventifier,Promise,dashboard,request,urlHelper){"use strict";return function($container){return eventifier({performChecks:function(){var self=this;new Promise(function(resolve){request(urlHelper.route("getMachineChecks","Synchronizer","taoSync")).then(function(data){resolve(data)})}).then(function(data){self.dashboard.toggleLoadingBar(!1),self.dashboard.renderMetrics(
data)})},render:function(){return this.dashboard=dashboard({renderTo:$container,loading:!0,headerText:!1,warningText:!1,layoutType:"list"}),this.performChecks(),this},destroy:function(){return this.dashboard&&this.dashboard.destroy(),this.trigger("destroy"),this}})}}),define("taoSync/controller/synchronizer/index",["jquery","lodash","moment","core/dataProvider/request","util/url","ui/taskQueue/taskQueueModel","layout/loading-bar","taoSync/component/terminateExecutions/terminateExecutions","taoSync/component/readinessDashboard/readinessDashboard"],function($,_,moment,request,urlHelper,taskQueueModelFactory,loadingBar,terminateExecutionsDialogFactory,
readinessDashboardFactory){"use strict";var tq_api="TaskQueueWebApi",tq_ext="taoTaskQueue",webservices={get:urlHelper.route("get",tq_api,tq_ext),archive:urlHelper.route("archive",tq_api,tq_ext),all:urlHelper.route("getAll",tq_api,tq_ext),download:urlHelper.route("download",tq_api,tq_ext),lastTask:urlHelper.route("lastTask","Synchronizer","taoSync"),activeSessions:urlHelper.route("activeSessions","Synchronizer","taoSync"),terminateExecutions:urlHelper.route("terminateExecutions","TerminateExecution","taoSync")};return{start:function(){var readinessDashboard,_msg,$container=$("#tao-sync-container"),$syncForm=$container.find("form.sync-form"),$syncFormFields=(
$container.find("form.sync-form"),$syncForm.find("input, select")),$launchButton=$syncForm.find('button[data-control="launch"]'),$spinner=$syncForm.find(".feedback-info .icon-loop"),timeFields={$enqueued:$syncForm.find(".enqueue-time"),$updated:$syncForm.find(".update-time"),$completed:$syncForm.find(".complete-time")},msg=((_msg={$all:$syncForm.find(".msg")}).$all.each(function(){var $currentMsg=$(this);_msg["$"+$currentMsg.data("type")]=$currentMsg}),_msg),taskQueue=taskQueueModelFactory({url:{get:webservices.get,archive:webservices.archive,all:webservices.all,download:webservices.download},pollSingleIntervals:[{iteration:Number.MAX_SAFE_INTEGER,
interval:2e3}],pollAllIntervals:[{iteration:1,interval:8e3},{iteration:0,interval:5e3}]}).on("pollSingleFinished",function(taskId,taskData){"completed"===taskData.status?(setState("success"),updateTime(taskData),setHistoryTime(taskData.updatedAt,"$completed")):"failed"===taskData.status&&setState("error")}).on("pollSingle",function(taskId,taskData){updateTime(taskData)}).on("error",function(error){error.response&&400<=error.response.errorCode&&error.response.errorCode<500?setState("error",error.response.errorMsg):setState("error")});function getData(){var data={label:"Data Synchronization"};return $syncFormFields.each(function(){data[this.name]=this.value}),
data}function toggleLaunchButtonState(){var isValid=!0;$syncFormFields.each(function(){return isValid=this.validity.valid}),isValid?$launchButton.removeAttr("disabled"):$launchButton.attr("disabled","disabled")}function setState(state,message){if($container.removeClass(function(index,className){return(className.match(/(^|\s)state-\S+/g)||[]).join(" ")}),$spinner["progress"===state?"addClass":"removeClass"]("spinner-icon"),$container.addClass("state-"+state),msg.$all.hide(),message){var statusClassName=".status-"+state;$container.find(statusClassName+" .messages p span:first-child").text(message)}"success"===state||"error"===state?function(){
var $dashboardContainer=$container.find("#dashboard-container");readinessDashboard=readinessDashboardFactory($dashboardContainer).render()}():readinessDashboard&&readinessDashboard.destroy()}function updateTime(taskData){setTime(taskData.createdAt,"$enqueued"),setTime(taskData.createdAt+taskData.createdAtElapsed,"$updated")}function setTime(timestamp,type){timeFields[type]&&timeFields[type].text(moment.unix(timestamp).format("LTS")),msg[type]&&msg[type].show()}function setHistoryTime(timestamp,type){setTime(timestamp,type),$container.addClass("history")}$container.find(".fb-container").removeClass("viewport-hidden"),loadingBar.start(),$syncFormFields.on(
"keyup paste blur",toggleLaunchButtonState),toggleLaunchButtonState(),$syncForm.on("submit",function(e){var action=this.action;e.preventDefault(),setState("progress"),$container.removeClass("active"),request(webservices.activeSessions).then(function(data){if(Array.isArray(data.activeSessionsData)&&0<data.activeSessionsData.length){var $terminateActionContainer=$container.find(".terminate-action"),$syncActionContainer=$container.find(".sync-action"),dialogConfig={data:data.activeSessionsData,csrfToken:data.token,terminateUrl:webservices.terminateExecutions};terminateExecutionsDialogFactory($terminateActionContainer,dialogConfig).on("dialogRendered",function(
){$syncActionContainer.toggle(),$terminateActionContainer.toggle()}).on("terminationCanceled",function(){$terminateActionContainer.toggle(),setState("form"),$syncActionContainer.toggle()}).on("terminationFailed",function(){}).on("terminationSucceeded",function(){$terminateActionContainer.toggle(),$syncActionContainer.toggle(),taskQueue.create(action,getData())}).render($terminateActionContainer)}else taskQueue.create(action,getData())}).catch(function(){setState("error")})}),$syncForm.find('button[data-control="close"]').on("click",function(e){e.preventDefault(),setState("form")}),request(webservices.lastTask).then(function(currentTask){if(
currentTask&&currentTask.status)switch(currentTask.status){case"failed":setState("error");break;case"completed":setState("form"),updateTime(currentTask),setHistoryTime(currentTask.updatedAt,"$completed");break;default:setState("progress"),updateTime(currentTask),taskQueue.pollSingle(currentTask.id)}else setState("form");loadingBar.stop()}).catch(function(){setState("error")})}}}),define("taoSync/loader/taoSync.bundle",function(){});
//# sourceMappingURL=taoSync.min.js.map